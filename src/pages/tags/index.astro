---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

const articles = await getCollection("articles", ({ data }) => {
  return import.meta.env.PROD ? !data.draft : true;
});

const tags = [
  ...new Set(articles.flatMap((a) => a.data.tags || [])),
].toSorted();
---

<Layout>
  <main class="max-w-screen-md mx-auto px-6 py-12">
    <h1 class="text-3xl font-bold mb-8 text-gray-900">タグ一覧</h1>
    <ul class="flex flex-col gap-4 list-none p-0">
      {
        tags.map((tag) => {
          const count = articles.filter((a) =>
            (a.data.tags || []).includes(tag),
          ).length;
          return (
            <li>
              <a
                href={`/tags/${tag}`}
                class="flex items-center gap-2 text-lg text-gray-900 hover:text-blue-500 transition-colors"
              >
                <span class="font-medium">#{tag}</span>
                <span class="text-sm text-gray-500">({count})</span>
              </a>
            </li>
          );
        })
      }
    </ul>
  </main>
</Layout>
