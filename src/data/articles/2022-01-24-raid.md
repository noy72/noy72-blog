---
title: RAID 5 を設定するだけなのに数日かかった話
tags: ["雑記"]
thumbnail: "https://i.imgur.com/rcy6kBBm.webp"
---

バックアップや復元に失敗して時間を無駄にした話



https://i.imgur.com/rcy6kBB



## 背景

デスクトップ PC のストレージは以下の 3つを使っている。

- SSD 256G
  - 設定ファイルとか OS のインストールとか
- HDD 2T
  - ゲームとかフリーソフトとか
- HDD 6T
  - 2T のが埋まりそうになってきた＋そろそろ壊れそうなのでその代わり



HDD がひとつしかなかったときはバックアップに 2T の外付け HDD を使っていた。しかし、6Tの HDD を使っていくとなるとバックアップに使うストレージがない。外付けで6Tの HDD を買っても良いが値段的に HDD を増設した方が安い。そんなことを考え、せっかくなので RAID を設定することにした。



## やりたかったこと

- 今使っている6Tの HDD をバックアップする。保存先は外付けHDD
  - この時点では、まだデータが2T以下しか入っていなかった
- 6Tの HDD を2つ買う
- 6T * 3 で RAID 5 を設定する
- 外付け HDD のバックアップを復元する



## 実際に起こったこと

### 6Tの HDD を「ディスクバックアップ」した

バックアップには AOMEI Backupper Standard を使ってディスクバックアップした。ディスクバックアップとはディスクの内容を丸ごとバックアップするもので、復元時には対象となるパーティションを上書きする。基本的にはバックアップファイルから任意のファイルを取り出す、ということはできない（有料版ならできる）。これだけで 12時間以上かかった。



### 2T の HDD が瀕死になる

RAID の構築は簡単で、Windows10なら GUI をポチポチするだけで設定できる。

どきどきしながら HDD を繋ぎかえRAID 5を構築し、安堵したのも束の間、2Tの HDD が認識されていない。慌てて接続を確かめて再起動すると、黒い画面に白い文字……

2Tの HDD の **S.M.A.R.T. Status が Bad らしい**

え？ 壊れた？

と思ったらこれはまだ壊れきっていないらしい。早くデータを移さないとまずいと思って**2Tの HDD のバックアップを RAID を設定した HDD に取ってしまった**。

さらに面倒なことに、ディスクバックアップを取ろうとしたら70%ぐらい終わったところで不良セクタが原因で失敗してしまう。諦めていくつかのディレクトリ（それでも1.5T以上ある）をコピーすることにした。 1日以上かかった。



### 順番を間違えた

2TBの HDD からデータを移せたので、次は6Tの HDD のデータを復元しよう、と思ったら**ディスクバックアップとはディスクの内容を丸ごとバックアップするもので、復元時には対象となるパーティションを上書きする**という壁に阻まれる。

そうか、先にとっちゃいけなかったか……

どうするか考えた結果、

1. RAIDを設定した HDD のパーティションを切る
2. 切ったパーティションで仮想 HDD を作る
   1. 今考えればこれパーティション切るだけでよかったのでは？？？
3. 仮想 HDD に対し復元する
4. 復元したデータを別のパーティションにコピーする
5. 仮想 HDD を消して結合する

にすることにした。



仮想 HDD を作るのに1日待った。



### なんでアップデートしてしまうん？

仮想 HDD ができたら次は復元。順調に進んでいる、と思ったら朝起きたときには「電源はついており HDD も動いているっぽいが、画面に何も映らないしマウスも接続されていないっぽい」という状態になっていた。

何もわからないのでしばらく待ってから再起動してみると復元はできておらず、仮想 HDD を再フォーマットする羽目になった。多分犯人はWindows Update。復元中に夜中アップデートが走り、シャットダウンされたに違いない。

17時間ぐらいの復元が( ᐛ👐) *パァ*になる。



### 復元してコピーする

安全のため自動アップデートを一時的に無効化して復元＋ファイルのコピーをした。1日ぐらいかかった。ここまできてようやく平穏を得たのだった。



### つまり何したの？

1. バックアップとる
2. RAIDを設定する
3. バックアップとる
4. バックアップに失敗したのでもう1度やる
5. 仮想 HDD 作る
6. 復元する
7. 復元に失敗したのでもう1度やる
8. ファイルを移動する

移動させるデータが2T弱あるので結構時間がかかった。フツーにファイルバックアップにしておけばよかったね。



## 余談

デスクトップ PC はまな板 PC なので HDD はむき出しで置かれている。4 台の HDD を積み上げるのは怖いので、[裸族のビキニ](https://www.century.co.jp/products/crbk2.html)を使って積むことにした。ただ、HDD が若干厚いせいでパーツが反ってしまい凹凸がうまくハマらず、単に乗っけるだけになっている。

